# Vidar Stealer 2.0 - Indicators of Compromise

## 2025-10-31: Vidar Stealer 2.0
**Author:** Rhys Downing

**References:**
- https://www.ontinue.com/resources/?resource_type[]=blog

---

## Vidar Function Rename Script - Python/Ghidra Script

```python
# Renames Vidar malware functions
#@category Analysis.Malware
#@author Rhys Downing
#@menupath Tools.Malware.Rename Vidar Functions

from ghidra.program.model.symbol import SourceType

# Function naming map - Complete list from original script
function_names = {
    0x140001018: "main_execution_wrapper",
    0x140001458: "initialization_routine",
    0x14003fa19: "steal_azure_msal_localappdata",
    0x14003eaf4: "steal_azure_msal_userprofile",
    0x14003ec16: "recursive_file_stealer_engine",
    0x1400064cc: "http_upload_multipart_form",
    0x14000906e: "http_request_wrapper",
    0x14000921e: "add_file_to_exfil_archive",
    0x1400083e0: "cleanup_http_response_buffer",
    0x14003d2d8: "steal_browser_passwords",
    0x140021860: "browser_profile_enumeration",
    0x14001228c: "steal_browser_cookies",
    0x140012877: "steal_browser_history",
    0x14001379d: "browser_v20_key_extraction",
    0x140014d6c: "decrypt_browser_v20_key",
    0x1400154f0: "validate_v20_key",
    0x1400157fb: "queue_v20_key_upload",
    0x140029156: "steal_crypto_wallets",
    0x14002991e: "enumerate_wallet_files",
    0x140029ab8: "read_wallet_data",
    0x140037389: "steal_telegram_sessions",
    0x140038111: "enumerate_telegram_files",
    0x140031e36: "steal_steam_credentials",
    0x140032336: "parse_steam_loginusers",
    0x140033f84: "enumerate_steam_files",
    0x14003f88b: "steal_aws_credentials",
    0x14000602b: "parse_url_components",
    0x14001ea48: "read_file_to_buffer",
    0x14001eeb9: "write_data_to_file",
    0x14000f29b: "enumerate_directory",
    0x14000f5c8: "check_file_exists",
    0x140002c39: "get_string_pointer",
    0x140005f4b: "extract_substring",
    0x14004479a: "find_substring_in_string",
    0x1400413ac: "get_system_info",
    0x1400415e4: "generate_hwid",
    0x140040eb8: "check_debugger_present",
    0x140040f21: "get_tick_count_wrapper",
    0x1400411a9: "get_process_id",
    0x140041bf3: "sleep_or_delay",
    0x140041c58: "anti_debug_check_1",
    0x140041df7: "anti_debug_check_2",
    0x140045dd2: "base64_encode",
    0x140048654: "base64_decode_or_encode",
    0x140047fb2: "memcpy_wrapper",
    0x140047d9c: "memset_wrapper",
    0x1400480e2: "get_stack_cookie",
}

print("=" * 70)
print("Vidar Malware Function Renamer")
print("=" * 70)
print("Total functions to rename: {}".format(len(function_names)))
print("")

renamed_count = 0
not_found_count = 0
collision_count = 0

# Start transaction
transaction_id = currentProgram.startTransaction("Rename Vidar Functions")
success = False

try:
    for address, name in function_names.items():
        # Check for cancellation
        if monitor.isCancelled():
            print("\n[!] Script cancelled by user")
            break
            
        addr = toAddr(address)
        func = getFunctionAt(addr)
        
        if func:
            old_name = func.getName()
            actual_name = func.setName(name, SourceType.USER_DEFINED)
            
            if actual_name != name:
                print("[!] 0x{:x}: {} -> {} (collision, became {})".format(
                    address, old_name, name, actual_name))
                collision_count += 1
            else:
                print("[+] 0x{:x}: {} -> {}".format(address, old_name, name))
            renamed_count += 1
        else:
            print("[-] 0x{:x}: No function found (skipping {})".format(address, name))
            not_found_count += 1
    
    success = True
    
except Exception as e:
    print("\n[ERROR] Exception during renaming: {}".format(e))
    import traceback
    traceback.print_exc()
    raise
finally:
    currentProgram.endTransaction(transaction_id, success)

# Print summary
print("")
print("=" * 70)
print("Renaming Summary")
print("=" * 70)
print("Successfully renamed: {} functions".format(renamed_count))
if collision_count > 0:
    print("Name collisions:      {} functions".format(collision_count))
if not_found_count > 0:
    print("Functions not found:  {} functions".format(not_found_count))
print("=" * 70)

if success:
    print("\n[SUCCESS] Transaction committed successfully")
else:
    print("\n[FAILED] Transaction rolled back due to error")
```
---
